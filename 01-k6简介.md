# 第1章：k6 简介

## 1.1 什么是 k6

k6 是一款现代化的开源性能测试工具，由 **Grafana Labs** 开发并维护。它使用 Go 语言编写运行时引擎，支持使用 JavaScript（ES6+）编写测试脚本，专为开发者和 DevOps 工程师设计。

### 核心特点

- **高性能**：单机可模拟 10,000+ 并发用户
- **低资源消耗**：内存占用仅为传统工具的 1/3
- **开发者友好**：使用熟悉的 JavaScript 语言
- **CI/CD 原生支持**：完美集成到自动化流程
- **云原生**：支持容器化和分布式执行

## 1.2 k6 的发展历史

### 起源

k6 最初由 Load Impact 公司开发，旨在解决传统性能测试工具的痛点：
- 资源消耗高
- 学习曲线陡峭
- CI/CD 集成困难
- 脚本维护成本高

### 重要里程碑

- **2017年**：k6 首次发布
- **2020年**：Grafana Labs 收购 Load Impact，k6 成为 Grafana 生态的一部分
- **2021年**：k6 Cloud 正式发布，支持分布式测试
- **2022年至今**：持续更新，功能不断完善

### 当前状态

- GitHub Stars: 22,000+
- 活跃社区：Slack 成员 10,000+
- 更新频率：每月发布新版本
- 企业采用：越来越多的公司选择 k6

## 1.3 k6 的核心优势

### 1. 性能优势

**单机并发能力**：
- k6：10,000+ 虚拟用户
- JMeter：500-1,000 线程（受 JVM 限制）

**资源消耗对比**（100 并发用户）：
- k6：~80-150 MB 内存
- JMeter：~300-500 MB 内存

**启动速度**：
- k6：<1 秒
- JMeter：5-15 秒

### 2. 开发体验优势

**脚本语言**：
```javascript
// k6：简洁的 JavaScript
import http from 'k6/http';
export default function () {
  http.get('https://api.example.com');
}
```

**版本控制友好**：
- 纯文本文件，易于 diff
- 代码审查方便
- 合并冲突少

### 3. CI/CD 集成优势

**原生支持**：
- 命令行工具，无需 GUI
- 退出码明确（阈值失败返回非0）
- JSON/CSV 输出格式标准

**容器化友好**：
- 轻量级镜像（~50MB）
- 快速启动
- 资源占用低

### 4. 现代化特性

- ES6+ JavaScript 支持
- 模块化设计
- npm 包支持（通过 jslib.k6.io）
- TypeScript 支持（通过工具链）

## 1.4 k6 的适用人群

### 主要用户群体

1. **开发工程师**
   - 需要快速验证 API 性能
   - 集成到开发流程
   - 代码审查时验证性能

2. **DevOps 工程师**
   - CI/CD 流程集成
   - 持续性能监控
   - 自动化测试

3. **测试工程师**
   - API 性能测试
   - 微服务性能测试
   - 自动化测试脚本编写

4. **架构师**
   - 系统容量规划
   - 性能基准测试
   - 技术选型评估

### 不适合的场景

- 需要 GUI 工具的非技术人员
- 需要测试传统协议（FTP、LDAP 等）
- 需要详细的图形化报告（k6 需要配合 Grafana）

## 1.5 k6 在性能测试领域的地位

### 市场定位

k6 定位为**现代化、开发者友好的性能测试工具**，主要竞争对手：

1. **JMeter**：传统性能测试工具，功能全面但资源消耗高
2. **Gatling**：Scala 编写，性能优秀但学习曲线陡
3. **Locust**：Python 编写，分布式支持好但单机性能一般

### 技术趋势

**k6 符合以下技术趋势**：

1. **云原生**
   - 容器化部署
   - Kubernetes 支持
   - 微服务架构

2. **DevOps 文化**
   - 左移测试（Shift Left）
   - 持续集成
   - 基础设施即代码

3. **开发者体验**
   - 代码即配置
   - 版本控制友好
   - 自动化优先

### 行业采用

**采用 k6 的公司类型**：
- 互联网公司（字节、阿里、腾讯等）
- 云服务提供商
- SaaS 公司
- 金融科技公司

**典型用例**：
- API 性能测试
- 微服务性能验证
- CI/CD 持续测试
- 容量规划

## 1.6 k6 生态系统

### 核心组件

1. **k6 核心**：命令行工具
2. **k6 Cloud**：云服务，支持分布式测试
3. **k6 扩展**：官方和第三方扩展
4. **Grafana 集成**：可视化监控

### 社区资源

- **官方文档**：https://grafana.com/docs/k6/latest/
- **GitHub**：https://github.com/grafana/k6
- **Slack 社区**：https://k6.io/slack
- **示例脚本**：https://github.com/grafana/k6-docs

## 1.7 快速开始

### 安装 k6

**macOS**：
```bash
brew install k6
```

**Linux**：
```bash
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys C5AD17C747E3415A3642D57D77C6C491D6AC1D69
echo "deb https://dl.k6.io/deb stable main" | sudo tee /etc/apt/sources.list.d/k6.list
sudo apt-get update
sudo apt-get install k6
```

### 第一个测试脚本

创建 `test.js`：
```javascript
import http from 'k6/http';
import { check } from 'k6';

export const options = {
  vus: 10,
  duration: '30s',
};

export default function () {
  const response = http.get('https://test-api.k6.io/public/crocodiles/');
  check(response, {
    '状态码是 200': (r) => r.status === 200,
  });
}
```

运行测试：
```bash
k6 run test.js
```

## 1.8 总结

k6 是一款现代化的性能测试工具，具有以下特点：

✅ **高性能**：单机可模拟大量并发用户  
✅ **低消耗**：资源占用低，启动快速  
✅ **易使用**：JavaScript 脚本，开发者友好  
✅ **易集成**：完美支持 CI/CD 流程  
✅ **现代化**：符合云原生和 DevOps 趋势  

在接下来的章节中，我们将深入学习 k6 的核心原理、使用方法和最佳实践。

---

**下一章**：[第2章：k6 核心原理](./02-k6核心原理.md)

